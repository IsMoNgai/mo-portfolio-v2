import{r as y,j as G}from"./react-B5MDO8QK.js";import{L as Ee,T as De,R as Wt,U as Bt,a as It,O as He,P as We,S as Ke,b as xe,N as $t,A as Nt,B as Gt,M as qt,C as Ut,V as N,c as ut,W as Vt,d as Xt,e as Yt,f as Zt,g as Kt,h as Jt,i as Qt,D as er,j as me,k as Be,l as tr,E as ft,m as rr,n as nr,o as or,p as ir}from"./three-CWcbmaB3.js";import{c as Je}from"./debounce-Dg93uZgN.js";import{F as sr,u as ar}from"./its-fine-DIIw4VH7.js";import{R as cr,c as ie}from"./react-reconciler-Cw807X9j.js";import{s as Qe}from"./scheduler-CzFDRTuY.js";import{_ as Ie}from"./@babel-CF3RwP-h.js";import{c as lr}from"./react-dom-C9nsoTc8.js";import{c as dt}from"./zustand-3hBhX-Hx.js";import"./maath-CKsHv_sf.js";import{D as ur,G as $e,a as fr,M as Ce,O as dr}from"./three-stdlib-q1qJaaZ4.js";import{s as pr,p as mr,c as vr}from"./suspend-react-BKIKQNXN.js";const hr="modulepreload",gr=function(e){return"/mo-portfolio-v2/"+e},et={},vn=function(t,n,i){let c=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),m=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));c=Promise.all(n.map(u=>{if(u=gr(u),u in et)return;et[u]=!0;const f=u.endsWith(".css"),h=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const r=document.createElement("link");if(r.rel=f?"stylesheet":hr,f||(r.as="script"),r.crossOrigin="",r.href=u,m&&r.setAttribute("nonce",m),document.head.appendChild(r),f)return new Promise((o,l)=>{r.addEventListener("load",o),r.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${u}`)))})}))}return c.then(()=>t()).catch(s=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=s,window.dispatchEvent(m),!m.defaultPrevented)throw s})},Ne={},yr=e=>void Object.assign(Ne,e);function wr(e,t){function n(r,{args:o=[],attach:l,...v},g){let b=`${r[0].toUpperCase()}${r.slice(1)}`,p;if(r==="primitive"){if(v.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const a=v.object;p=ne(a,{type:r,root:g,attach:l,primitive:!0})}else{const a=Ne[b];if(!a)throw new Error(`R3F: ${b} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(o))throw new Error("R3F: The args prop must be an array!");p=ne(new a(...o),{type:r,root:g,attach:l,memoizedProps:{args:o}})}return p.__r3f.attach===void 0&&(p instanceof Gt?p.__r3f.attach="geometry":p instanceof qt&&(p.__r3f.attach="material")),b!=="inject"&&Me(p,v),p}function i(r,o){let l=!1;if(o){var v,g;(v=o.__r3f)!=null&&v.attach?_e(r,o,o.__r3f.attach):o.isObject3D&&r.isObject3D&&(r.add(o),l=!0),l||(g=r.__r3f)==null||g.objects.push(o),o.__r3f||ne(o,{}),o.__r3f.parent=r,ze(o),oe(o)}}function c(r,o,l){let v=!1;if(o){var g,b;if((g=o.__r3f)!=null&&g.attach)_e(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){o.parent=r,o.dispatchEvent({type:"added"}),r.dispatchEvent({type:"childadded",child:o});const p=r.children.filter(d=>d!==o),a=p.indexOf(l);r.children=[...p.slice(0,a),o,...p.slice(a)],v=!0}v||(b=r.__r3f)==null||b.objects.push(o),o.__r3f||ne(o,{}),o.__r3f.parent=r,ze(o),oe(o)}}function s(r,o,l=!1){r&&[...r].forEach(v=>m(o,v,l))}function m(r,o,l){if(o){var v,g,b;if(o.__r3f&&(o.__r3f.parent=null),(v=r.__r3f)!=null&&v.objects&&(r.__r3f.objects=r.__r3f.objects.filter(_=>_!==o)),(g=o.__r3f)!=null&&g.attach)it(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){var p;r.remove(o),(p=o.__r3f)!=null&&p.root&&Or(ye(o),o)}const d=(b=o.__r3f)==null?void 0:b.primitive,x=!d&&(l===void 0?o.dispose!==null:l);if(!d){var a;s((a=o.__r3f)==null?void 0:a.objects,o,x),s(o.children,o,x)}if(delete o.__r3f,x&&o.dispose&&o.type!=="Scene"){const _=()=>{try{o.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?Qe.unstable_scheduleCallback(Qe.unstable_IdlePriority,_):_()}oe(r)}}function u(r,o,l,v){var g;const b=(g=r.__r3f)==null?void 0:g.parent;if(!b)return;const p=n(o,l,r.__r3f.root);if(r.children){for(const a of r.children)a.__r3f&&i(p,a);r.children=r.children.filter(a=>!a.__r3f)}r.__r3f.objects.forEach(a=>i(p,a)),r.__r3f.objects=[],r.__r3f.autoRemovedBeforeAppend||m(b,r),p.parent&&(p.__r3f.autoRemovedBeforeAppend=!0),i(b,p),p.raycast&&p.__r3f.eventCount&&ye(p).getState().internal.interaction.push(p),[v,v.alternate].forEach(a=>{a!==null&&(a.stateNode=p,a.ref&&(typeof a.ref=="function"?a.ref(p):a.ref.current=p))})}const f=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:cr({createInstance:n,removeChild:m,appendChild:i,appendInitialChild:i,insertBefore:c,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(r,o)=>{if(!o)return;const l=r.getState().scene;l.__r3f&&(l.__r3f.root=r,i(l,o))},removeChildFromContainer:(r,o)=>{o&&m(r.getState().scene,o)},insertInContainerBefore:(r,o,l)=>{if(!o||!l)return;const v=r.getState().scene;v.__r3f&&c(v,o,l)},getRootHostContext:()=>null,getChildHostContext:r=>r,finalizeInitialChildren(r){var o;return!!((o=r==null?void 0:r.__r3f)!=null?o:{}).handlers},prepareUpdate(r,o,l,v){var g;if(((g=r==null?void 0:r.__r3f)!=null?g:{}).primitive&&v.object&&v.object!==r)return[!0];{const{args:p=[],children:a,...d}=v,{args:x=[],children:_,...C}=l;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((S,R)=>S!==x[R]))return[!0];const E=wt(r,d,C,!0);return E.changes.length?[!1,E]:null}},commitUpdate(r,[o,l],v,g,b,p){o?u(r,v,b,p):Me(r,l)},commitMount(r,o,l,v){var g;const b=(g=r.__r3f)!=null?g:{};r.raycast&&b.handlers&&b.eventCount&&ye(r).getState().internal.interaction.push(r)},getPublicInstance:r=>r,prepareForCommit:()=>null,preparePortalMount:r=>ne(r.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(r){var o;const{attach:l,parent:v}=(o=r.__r3f)!=null?o:{};l&&v&&it(v,r,l),r.isObject3D&&(r.visible=!1),oe(r)},unhideInstance(r,o){var l;const{attach:v,parent:g}=(l=r.__r3f)!=null?l:{};v&&g&&_e(g,r,v),(r.isObject3D&&o.visible==null||o.visible)&&(r.visible=!0),oe(r)},createTextInstance:f,hideTextInstance:f,unhideTextInstance:f,getCurrentEventPriority:()=>t?t():ie.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&L.fun(performance.now)?performance.now:L.fun(Date.now)?Date.now:()=>0,scheduleTimeout:L.fun(setTimeout)?setTimeout:void 0,cancelTimeout:L.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Me}}var tt,rt;const Pe=e=>"colorSpace"in e||"outputColorSpace"in e,pt=()=>{var e;return(e=Ne.ColorManagement)!=null?e:null},mt=e=>e&&e.isOrthographicCamera,br=e=>e&&e.hasOwnProperty("current"),fe=typeof window<"u"&&((tt=window.document)!=null&&tt.createElement||((rt=window.navigator)==null?void 0:rt.product)==="ReactNative")?y.useLayoutEffect:y.useEffect;function vt(e){const t=y.useRef(e);return fe(()=>void(t.current=e),[e]),t}function Er({set:e}){return fe(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class ht extends y.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}ht.getDerivedStateFromError=()=>({error:!0});const gt="__default",nt=new Map,xr=e=>e&&!!e.memoized&&!!e.changes;function yt(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const ce=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()};function ye(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const L={obj:e=>e===Object(e)&&!L.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:i="reference",strict:c=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(L.str(e)||L.num(e)||L.boo(e))return e===t;const s=L.obj(e);if(s&&i==="reference")return e===t;const m=L.arr(e);if(m&&n==="reference")return e===t;if((m||s)&&e===t)return!0;let u;for(u in e)if(!(u in t))return!1;if(s&&n==="shallow"&&i==="shallow"){for(u in c?t:e)if(!L.equ(e[u],t[u],{strict:c,objects:"reference"}))return!1}else for(u in c?t:e)if(e[u]!==t[u])return!1;if(L.und(u)){if(m&&e.length===0&&t.length===0||s&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Cr(e){const t={nodes:{},materials:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material)}),t}function Pr(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function ne(e,t){const n=e;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function ke(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),c=i.pop();return n=i.reduce((s,m)=>s[m],e),{target:n,key:c}}else return{target:n,key:t}}const ot=/-\d+$/;function _e(e,t,n){if(L.str(n)){if(ot.test(n)){const s=n.replace(ot,""),{target:m,key:u}=ke(e,s);Array.isArray(m[u])||(m[u]=[])}const{target:i,key:c}=ke(e,n);t.__r3f.previousAttach=i[c],i[c]=t}else t.__r3f.previousAttach=n(e,t)}function it(e,t,n){var i,c;if(L.str(n)){const{target:s,key:m}=ke(e,n),u=t.__r3f.previousAttach;u===void 0?delete s[m]:s[m]=u}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(c=t.__r3f)==null||delete c.previousAttach}function wt(e,{children:t,key:n,ref:i,...c},{children:s,key:m,ref:u,...f}={},h=!1){const r=e.__r3f,o=Object.entries(c),l=[];if(h){const g=Object.keys(f);for(let b=0;b<g.length;b++)c.hasOwnProperty(g[b])||o.unshift([g[b],gt+"remove"])}o.forEach(([g,b])=>{var p;if((p=e.__r3f)!=null&&p.primitive&&g==="object"||L.equ(b,f[g]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(g))return l.push([g,b,!0,[]]);let a=[];g.includes("-")&&(a=g.split("-")),l.push([g,b,!1,a]);for(const d in c){const x=c[d];d.startsWith(`${g}-`)&&l.push([d,x,!1,d.split("-")])}});const v={...c};return r!=null&&r.memoizedProps&&r!=null&&r.memoizedProps.args&&(v.args=r.memoizedProps.args),r!=null&&r.memoizedProps&&r!=null&&r.memoizedProps.attach&&(v.attach=r.memoizedProps.attach),{memoized:v,changes:l}}const _r=typeof process<"u"&&!1;function Me(e,t){var n;const i=e.__r3f,c=i==null?void 0:i.root,s=c==null||c.getState==null?void 0:c.getState(),{memoized:m,changes:u}=xr(t)?t:wt(e,t),f=i==null?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=m);for(let r=0;r<u.length;r++){let[o,l,v,g]=u[r];if(Pe(e)){const d="srgb",x="srgb-linear";o==="encoding"?(o="colorSpace",l=l===3001?d:x):o==="outputEncoding"&&(o="outputColorSpace",l=l===3001?d:x)}let b=e,p=b[o];if(g.length&&(p=g.reduce((a,d)=>a[d],e),!(p&&p.set))){const[a,...d]=g.reverse();b=d.reverse().reduce((x,_)=>x[_],e),o=a}if(l===gt+"remove")if(b.constructor){let a=nt.get(b.constructor);a||(a=new b.constructor,nt.set(b.constructor,a)),l=a[o]}else l=0;if(v&&i)l?i.handlers[o]=l:delete i.handlers[o],i.eventCount=Object.keys(i.handlers).length;else if(p&&p.set&&(p.copy||p instanceof Ee)){if(Array.isArray(l))p.fromArray?p.fromArray(l):p.set(...l);else if(p.copy&&l&&l.constructor&&(_r?p.constructor.name===l.constructor.name:p.constructor===l.constructor))p.copy(l);else if(l!==void 0){const a=p instanceof Ut;!a&&p.setScalar?p.setScalar(l):p instanceof Ee&&l instanceof Ee?p.mask=l.mask:p.set(l),!pt()&&s&&!s.linear&&a&&p.convertSRGBToLinear()}}else if(b[o]=l,b[o]instanceof De&&b[o].format===Wt&&b[o].type===Bt&&s){const a=b[o];Pe(a)&&Pe(s.gl)?a.colorSpace=s.gl.outputColorSpace:a.encoding=s.gl.outputEncoding}oe(e)}if(i&&i.parent&&e.raycast&&f!==i.eventCount){const r=ye(e).getState().internal,o=r.interaction.indexOf(e);o>-1&&r.interaction.splice(o,1),i.eventCount&&r.interaction.push(e)}return!(u.length===1&&u[0][0]==="onUpdate")&&u.length&&(n=e.__r3f)!=null&&n.parent&&ze(e),e}function oe(e){var t,n;const i=(t=e.__r3f)==null||(n=t.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function ze(e){e.onUpdate==null||e.onUpdate(e)}function Mr(e,t){e.manual||(mt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function ve(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Sr(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return ie.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return ie.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return ie.ContinuousEventPriority;default:return ie.DefaultEventPriority}}function bt(e,t,n,i){const c=n.get(t);c&&(n.delete(t),n.size===0&&(e.delete(i),c.target.releasePointerCapture(i)))}function Or(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(i=>i!==t),n.initialHits=n.initialHits.filter(i=>i!==t),n.hovered.forEach((i,c)=>{(i.eventObject===t||i.object===t)&&n.hovered.delete(c)}),n.capturedMap.forEach((i,c)=>{bt(n.capturedMap,t,i,c)})}function Rr(e){function t(f){const{internal:h}=e.getState(),r=f.offsetX-h.initialClick[0],o=f.offsetY-h.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}function n(f){return f.filter(h=>["Move","Over","Enter","Out","Leave"].some(r=>{var o;return(o=h.__r3f)==null?void 0:o.handlers["onPointer"+r]}))}function i(f,h){const r=e.getState(),o=new Set,l=[],v=h?h(r.internal.interaction):r.internal.interaction;for(let a=0;a<v.length;a++){const d=ce(v[a]);d&&(d.raycaster.camera=void 0)}r.previousRoot||r.events.compute==null||r.events.compute(f,r);function g(a){const d=ce(a);if(!d||!d.events.enabled||d.raycaster.camera===null)return[];if(d.raycaster.camera===void 0){var x;d.events.compute==null||d.events.compute(f,d,(x=d.previousRoot)==null?void 0:x.getState()),d.raycaster.camera===void 0&&(d.raycaster.camera=null)}return d.raycaster.camera?d.raycaster.intersectObject(a,!0):[]}let b=v.flatMap(g).sort((a,d)=>{const x=ce(a.object),_=ce(d.object);return!x||!_?a.distance-d.distance:_.events.priority-x.events.priority||a.distance-d.distance}).filter(a=>{const d=ve(a);return o.has(d)?!1:(o.add(d),!0)});r.events.filter&&(b=r.events.filter(b,r));for(const a of b){let d=a.object;for(;d;){var p;(p=d.__r3f)!=null&&p.eventCount&&l.push({...a,eventObject:d}),d=d.parent}}if("pointerId"in f&&r.internal.capturedMap.has(f.pointerId))for(let a of r.internal.capturedMap.get(f.pointerId).values())o.has(ve(a.intersection))||l.push(a.intersection);return l}function c(f,h,r,o){const l=e.getState();if(f.length){const v={stopped:!1};for(const g of f){const b=ce(g.object)||l,{raycaster:p,pointer:a,camera:d,internal:x}=b,_=new N(a.x,a.y,0).unproject(d),C=M=>{var w,j;return(w=(j=x.capturedMap.get(M))==null?void 0:j.has(g.eventObject))!=null?w:!1},E=M=>{const w={intersection:g,target:h.target};x.capturedMap.has(M)?x.capturedMap.get(M).set(g.eventObject,w):x.capturedMap.set(M,new Map([[g.eventObject,w]])),h.target.setPointerCapture(M)},S=M=>{const w=x.capturedMap.get(M);w&&bt(x.capturedMap,g.eventObject,w,M)};let R={};for(let M in h){let w=h[M];typeof w!="function"&&(R[M]=w)}let P={...g,...R,pointer:a,intersections:f,stopped:v.stopped,delta:r,unprojectedPoint:_,ray:p.ray,camera:d,stopPropagation(){const M="pointerId"in h&&x.capturedMap.get(h.pointerId);if((!M||M.has(g.eventObject))&&(P.stopped=v.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(w=>w.eventObject===g.eventObject))){const w=f.slice(0,f.indexOf(g));s([...w,g])}},target:{hasPointerCapture:C,setPointerCapture:E,releasePointerCapture:S},currentTarget:{hasPointerCapture:C,setPointerCapture:E,releasePointerCapture:S},nativeEvent:h};if(o(P),v.stopped===!0)break}}return f}function s(f){const{internal:h}=e.getState();for(const r of h.hovered.values())if(!f.length||!f.find(o=>o.object===r.object&&o.index===r.index&&o.instanceId===r.instanceId)){const l=r.eventObject.__r3f,v=l==null?void 0:l.handlers;if(h.hovered.delete(ve(r)),l!=null&&l.eventCount){const g={...r,intersections:f};v.onPointerOut==null||v.onPointerOut(g),v.onPointerLeave==null||v.onPointerLeave(g)}}}function m(f,h){for(let r=0;r<h.length;r++){const o=h[r].__r3f;o==null||o.handlers.onPointerMissed==null||o.handlers.onPointerMissed(f)}}function u(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return h=>{const{internal:r}=e.getState();"pointerId"in h&&r.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(h.pointerId)&&(r.capturedMap.delete(h.pointerId),s([]))})}}return function(r){const{onPointerMissed:o,internal:l}=e.getState();l.lastEvent.current=r;const v=f==="onPointerMove",g=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",p=i(r,v?n:void 0),a=g?t(r):0;f==="onPointerDown"&&(l.initialClick=[r.offsetX,r.offsetY],l.initialHits=p.map(x=>x.eventObject)),g&&!p.length&&a<=2&&(m(r,l.interaction),o&&o(r)),v&&s(p);function d(x){const _=x.eventObject,C=_.__r3f,E=C==null?void 0:C.handlers;if(C!=null&&C.eventCount)if(v){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const S=ve(x),R=l.hovered.get(S);R?R.stopped&&x.stopPropagation():(l.hovered.set(S,x),E.onPointerOver==null||E.onPointerOver(x),E.onPointerEnter==null||E.onPointerEnter(x))}E.onPointerMove==null||E.onPointerMove(x)}else{const S=E[f];S?(!g||l.initialHits.includes(_))&&(m(r,l.interaction.filter(R=>!l.initialHits.includes(R))),S(x)):g&&l.initialHits.includes(_)&&m(r,l.interaction.filter(R=>!l.initialHits.includes(R)))}}c(p,r,a,d)}}return{handlePointer:u}}const Et=e=>!!(e!=null&&e.render),xt=y.createContext(null),jr=(e,t)=>{const n=dt((u,f)=>{const h=new N,r=new N,o=new N;function l(a=f().camera,d=r,x=f().size){const{width:_,height:C,top:E,left:S}=x,R=_/C;d instanceof N?o.copy(d):o.set(...d);const P=a.getWorldPosition(h).distanceTo(o);if(mt(a))return{width:_/a.zoom,height:C/a.zoom,top:E,left:S,factor:1,distance:P,aspect:R};{const M=a.fov*Math.PI/180,w=2*Math.tan(M/2)*P,j=w*(_/C);return{width:j,height:w,top:E,left:S,factor:_/j,distance:P,aspect:R}}}let v;const g=a=>u(d=>({performance:{...d.performance,current:a}})),b=new ut;return{set:u,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(a=1)=>e(f(),a),advance:(a,d)=>t(a,d,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Jt,pointer:b,mouse:b,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const a=f();v&&clearTimeout(v),a.performance.current!==a.performance.min&&g(a.performance.min),v=setTimeout(()=>g(f().performance.max),a.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:a=>u(d=>({...d,events:{...d.events,...a}})),setSize:(a,d,x,_,C)=>{const E=f().camera,S={width:a,height:d,top:_||0,left:C||0,updateStyle:x};u(R=>({size:S,viewport:{...R.viewport,...l(E,r,S)}}))},setDpr:a=>u(d=>{const x=yt(a);return{viewport:{...d.viewport,dpr:x,initialDpr:d.viewport.initialDpr||x}}}),setFrameloop:(a="always")=>{const d=f().clock;d.stop(),d.elapsedTime=0,a!=="never"&&(d.start(),d.elapsedTime=0),u(()=>({frameloop:a}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:y.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(a,d,x)=>{const _=f().internal;return _.priority=_.priority+(d>0?1:0),_.subscribers.push({ref:a,priority:d,store:x}),_.subscribers=_.subscribers.sort((C,E)=>C.priority-E.priority),()=>{const C=f().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(d>0?1:0),C.subscribers=C.subscribers.filter(E=>E.ref!==a))}}}}}),i=n.getState();let c=i.size,s=i.viewport.dpr,m=i.camera;return n.subscribe(()=>{const{camera:u,size:f,viewport:h,gl:r,set:o}=n.getState();if(f.width!==c.width||f.height!==c.height||h.dpr!==s){var l;c=f,s=h.dpr,Mr(u,f),r.setPixelRatio(h.dpr);const v=(l=f.updateStyle)!=null?l:typeof HTMLCanvasElement<"u"&&r.domElement instanceof HTMLCanvasElement;r.setSize(f.width,f.height,v)}u!==m&&(m=u,o(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(u)}})))}),n.subscribe(u=>e(u)),n};let he,Tr=new Set,Ar=new Set,Lr=new Set;function Se(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function le(e,t){switch(e){case"before":return Se(Tr,t);case"after":return Se(Ar,t);case"tail":return Se(Lr,t)}}let Oe,Re;function je(e,t,n){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Oe=t.internal.subscribers,he=0;he<Oe.length;he++)Re=Oe[he],Re.ref.current(Re.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Dr(e){let t=!1,n=!1,i,c,s;function m(h){c=requestAnimationFrame(m),t=!0,i=0,le("before",h),n=!0;for(const o of e.values()){var r;s=o.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((r=s.gl.xr)!=null&&r.isPresenting)&&(i+=je(h,s))}if(n=!1,le("after",h),i===0)return le("tail",h),t=!1,cancelAnimationFrame(c)}function u(h,r=1){var o;if(!h)return e.forEach(l=>u(l.store.getState(),r));(o=h.gl.xr)!=null&&o.isPresenting||!h.internal.active||h.frameloop==="never"||(r>1?h.internal.frames=Math.min(60,h.internal.frames+r):n?h.internal.frames=2:h.internal.frames=1,t||(t=!0,requestAnimationFrame(m)))}function f(h,r=!0,o,l){if(r&&le("before",h),o)je(h,o,l);else for(const v of e.values())je(h,v.store.getState());r&&le("after",h)}return{loop:m,invalidate:u,advance:f}}function Ct(){const e=y.useContext(xt);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function $(e=n=>n,t){return Ct()(e,t)}function Ge(e,t=0){const n=Ct(),i=n.getState().internal.subscribe,c=vt(e);return fe(()=>i(c,t,n),[t,i,n]),null}const st=new WeakMap;function Pt(e,t){return function(n,...i){let c=st.get(n);return c||(c=new n,st.set(n,c)),e&&e(c),Promise.all(i.map(s=>new Promise((m,u)=>c.load(s,f=>{f.scene&&Object.assign(f,Cr(f.scene)),m(f)},t,f=>u(new Error(`Could not load ${s}: ${f==null?void 0:f.message}`))))))}}function Z(e,t,n,i){const c=Array.isArray(t)?t:[t],s=pr(Pt(n,i),[e,...c],{equal:L.equ});return Array.isArray(t)?s:s[0]}Z.preload=function(e,t,n){const i=Array.isArray(t)?t:[t];return mr(Pt(n),[e,...i])};Z.clear=function(e,t){const n=Array.isArray(t)?t:[t];return vr([e,...n])};const se=new Map,{invalidate:at,advance:ct}=Dr(se),{reconciler:we,applyProps:q}=wr(se,Sr),re={objects:"shallow",strict:!1},kr=(e,t)=>{const n=typeof e=="function"?e(t):e;return Et(n)?n:new Vt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function zr(e,t){const n=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:i,height:c,top:s,left:m,updateStyle:u=n}=t;return{width:i,height:c,top:s,left:m,updateStyle:u}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:c,top:s,left:m}=e.parentElement.getBoundingClientRect();return{width:i,height:c,top:s,left:m,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function Fr(e){const t=se.get(e),n=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const c=typeof reportError=="function"?reportError:console.error,s=i||jr(at,ct),m=n||we.createContainer(s,ie.ConcurrentRoot,null,!1,null,"",c,null);t||se.set(e,{fiber:m,store:s});let u,f=!1,h;return{configure(r={}){let{gl:o,size:l,scene:v,events:g,onCreated:b,shadows:p=!1,linear:a=!1,flat:d=!1,legacy:x=!1,orthographic:_=!1,frameloop:C="always",dpr:E=[1,2],performance:S,raycaster:R,camera:P,onPointerMissed:M}=r,w=s.getState(),j=w.gl;w.gl||w.set({gl:j=kr(o,e)});let H=w.raycaster;H||w.set({raycaster:H=new It});const{params:K,...k}=R||{};if(L.equ(k,H,re)||q(H,{...k}),L.equ(K,H.params,re)||q(H,{params:{...H.params,...K}}),!w.camera||w.camera===h&&!L.equ(h,P,re)){h=P;const T=P instanceof Xt,A=T?P:_?new He(0,0,0,0,.1,1e3):new We(75,0,.1,1e3);T||(A.position.z=5,P&&(q(A,P),("aspect"in P||"left"in P||"right"in P||"bottom"in P||"top"in P)&&(A.manual=!0,A.updateProjectionMatrix())),!w.camera&&!(P!=null&&P.rotation)&&A.lookAt(0,0,0)),w.set({camera:A}),H.camera=A}if(!w.scene){let T;v instanceof Ke?T=v:(T=new Ke,v&&q(T,v)),w.set({scene:ne(T)})}if(!w.xr){var U;const T=(O,Y)=>{const V=s.getState();V.frameloop!=="never"&&ct(O,!0,V,Y)},A=()=>{const O=s.getState();O.gl.xr.enabled=O.gl.xr.isPresenting,O.gl.xr.setAnimationLoop(O.gl.xr.isPresenting?T:null),O.gl.xr.isPresenting||at(O)},F={connect(){const O=s.getState().gl;O.xr.addEventListener("sessionstart",A),O.xr.addEventListener("sessionend",A)},disconnect(){const O=s.getState().gl;O.xr.removeEventListener("sessionstart",A),O.xr.removeEventListener("sessionend",A)}};typeof((U=j.xr)==null?void 0:U.addEventListener)=="function"&&F.connect(),w.set({xr:F})}if(j.shadowMap){const T=j.shadowMap.enabled,A=j.shadowMap.type;if(j.shadowMap.enabled=!!p,L.boo(p))j.shadowMap.type=xe;else if(L.str(p)){var z;const F={basic:Yt,percentage:Zt,soft:xe,variance:Kt};j.shadowMap.type=(z=F[p])!=null?z:xe}else L.obj(p)&&Object.assign(j.shadowMap,p);(T!==j.shadowMap.enabled||A!==j.shadowMap.type)&&(j.shadowMap.needsUpdate=!0)}const W=pt();W&&("enabled"in W?W.enabled=!x:"legacyMode"in W&&(W.legacyMode=x)),f||q(j,{outputEncoding:a?3e3:3001,toneMapping:d?$t:Nt}),w.legacy!==x&&w.set(()=>({legacy:x})),w.linear!==a&&w.set(()=>({linear:a})),w.flat!==d&&w.set(()=>({flat:d})),o&&!L.fun(o)&&!Et(o)&&!L.equ(o,j,re)&&q(j,o),g&&!w.events.handlers&&w.set({events:g(s)});const B=zr(e,l);return L.equ(B,w.size,re)||w.setSize(B.width,B.height,B.updateStyle,B.top,B.left),E&&w.viewport.dpr!==yt(E)&&w.setDpr(E),w.frameloop!==C&&w.setFrameloop(C),w.onPointerMissed||w.set({onPointerMissed:M}),S&&!L.equ(S,w.performance,re)&&w.set(T=>({performance:{...T.performance,...S}})),u=b,f=!0,this},render(r){return f||this.configure(),we.updateContainer(G.jsx(Hr,{store:s,children:r,onCreated:u,rootElement:e}),m,null,()=>{}),s},unmount(){_t(e)}}}function Hr({store:e,children:t,onCreated:n,rootElement:i}){return fe(()=>{const c=e.getState();c.set(s=>({internal:{...s.internal,active:!0}})),n&&n(c),e.getState().events.connected||c.events.connect==null||c.events.connect(i)},[]),G.jsx(xt.Provider,{value:e,children:t})}function _t(e,t){const n=se.get(e),i=n==null?void 0:n.fiber;if(i){const c=n==null?void 0:n.store.getState();c&&(c.internal.active=!1),we.updateContainer(null,i,null,()=>{c&&setTimeout(()=>{try{var s,m,u,f;c.events.disconnect==null||c.events.disconnect(),(s=c.gl)==null||(m=s.renderLists)==null||m.dispose==null||m.dispose(),(u=c.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(f=c.gl)!=null&&f.xr&&c.xr.disconnect(),Pr(c),se.delete(e)}catch{}},500)})}}we.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:y.version});const Te={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Wr(e){const{handlePointer:t}=Rr(e);return{priority:1,enabled:!0,compute(n,i,c){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(Te).reduce((n,i)=>({...n,[i]:t(i)}),{}),update:()=>{var n;const{events:i,internal:c}=e.getState();(n=c.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(c.lastEvent.current)},connect:n=>{var i;const{set:c,events:s}=e.getState();s.disconnect==null||s.disconnect(),c(m=>({events:{...m.events,connected:n}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([m,u])=>{const[f,h]=Te[m];n.addEventListener(f,u,{passive:h})})},disconnect:()=>{const{set:n,events:i}=e.getState();if(i.connected){var c;Object.entries((c=i.handlers)!=null?c:[]).forEach(([s,m])=>{if(i&&i.connected instanceof HTMLElement){const[u]=Te[s];i.connected.removeEventListener(u,m)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}function Br({debounce:e,scroll:t,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const c=n||typeof window<"u"&&window.ResizeObserver,[s,m]=y.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!c)return s.width=1280,s.height=800,[()=>{},s,()=>{}];const u=y.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s}),f=e?typeof e=="number"?e:e.scroll:null,h=e?typeof e=="number"?e:e.resize:null,r=y.useRef(!1);y.useEffect(()=>(r.current=!0,()=>void(r.current=!1)));const[o,l,v]=y.useMemo(()=>{const a=()=>{if(!u.current.element)return;const{left:d,top:x,width:_,height:C,bottom:E,right:S,x:R,y:P}=u.current.element.getBoundingClientRect(),M={left:d,top:x,width:_,height:C,bottom:E,right:S,x:R,y:P};u.current.element instanceof HTMLElement&&i&&(M.height=u.current.element.offsetHeight,M.width=u.current.element.offsetWidth),Object.freeze(M),r.current&&!Gr(u.current.lastBounds,M)&&m(u.current.lastBounds=M)};return[a,h?Je(a,h):a,f?Je(a,f):a]},[m,i,f,h]);function g(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(a=>a.removeEventListener("scroll",v,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null)}function b(){u.current.element&&(u.current.resizeObserver=new c(v),u.current.resizeObserver.observe(u.current.element),t&&u.current.scrollContainers&&u.current.scrollContainers.forEach(a=>a.addEventListener("scroll",v,{capture:!0,passive:!0})))}const p=a=>{!a||a===u.current.element||(g(),u.current.element=a,u.current.scrollContainers=Mt(a),b())};return $r(v,!!t),Ir(l),y.useEffect(()=>{g(),b()},[t,v,l]),y.useEffect(()=>g,[]),[p,s,o]}function Ir(e){y.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function $r(e,t){y.useEffect(()=>{if(t){const n=e;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[e,t])}function Mt(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:i,overflowY:c}=window.getComputedStyle(e);return[n,i,c].some(s=>s==="auto"||s==="scroll")&&t.push(e),[...t,...Mt(e.parentElement)]}const Nr=["x","y","top","bottom","left","right","width","height"],Gr=(e,t)=>Nr.every(n=>e[n]===t[n]),qr=y.forwardRef(function({children:t,fallback:n,resize:i,style:c,gl:s,events:m=Wr,eventSource:u,eventPrefix:f,shadows:h,linear:r,flat:o,legacy:l,orthographic:v,frameloop:g,dpr:b,performance:p,raycaster:a,camera:d,scene:x,onPointerMissed:_,onCreated:C,...E},S){y.useMemo(()=>yr(Qt),[]);const R=ar(),[P,M]=Br({scroll:!0,debounce:{scroll:50,resize:0},...i}),w=y.useRef(null),j=y.useRef(null);y.useImperativeHandle(S,()=>w.current);const H=vt(_),[K,k]=y.useState(!1),[U,z]=y.useState(!1);if(K)throw K;if(U)throw U;const W=y.useRef(null);fe(()=>{const T=w.current;M.width>0&&M.height>0&&T&&(W.current||(W.current=Fr(T)),W.current.configure({gl:s,events:m,shadows:h,linear:r,flat:o,legacy:l,orthographic:v,frameloop:g,dpr:b,performance:p,raycaster:a,camera:d,scene:x,size:M,onPointerMissed:(...A)=>H.current==null?void 0:H.current(...A),onCreated:A=>{A.events.connect==null||A.events.connect(u?br(u)?u.current:u:j.current),f&&A.setEvents({compute:(F,O)=>{const Y=F[f+"X"],V=F[f+"Y"];O.pointer.set(Y/O.size.width*2-1,-(V/O.size.height)*2+1),O.raycaster.setFromCamera(O.pointer,O.camera)}}),C==null||C(A)}}),W.current.render(G.jsx(R,{children:G.jsx(ht,{set:z,children:G.jsx(y.Suspense,{fallback:G.jsx(Er,{set:k}),children:t})})})))}),y.useEffect(()=>{const T=w.current;if(T)return()=>_t(T)},[]);const B=u?"none":"auto";return G.jsx("div",{ref:j,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:B,...c},...E,children:G.jsx("div",{ref:P,style:{width:"100%",height:"100%"},children:G.jsx("canvas",{ref:w,style:{display:"block"},children:n})})})}),hn=y.forwardRef(function(t,n){return G.jsx(sr,{children:G.jsx(qr,{...t,ref:n})})}),de=new N,qe=new N,Ur=new N,lt=new ut;function Vr(e,t,n){const i=de.setFromMatrixPosition(e.matrixWorld);i.project(t);const c=n.width/2,s=n.height/2;return[i.x*c+c,-(i.y*s)+s]}function Xr(e,t){const n=de.setFromMatrixPosition(e.matrixWorld),i=qe.setFromMatrixPosition(t.matrixWorld),c=n.sub(i),s=t.getWorldDirection(Ur);return c.angleTo(s)>Math.PI/2}function Yr(e,t,n,i){const c=de.setFromMatrixPosition(e.matrixWorld),s=c.clone();s.project(t),lt.set(s.x,s.y),n.setFromCamera(lt,t);const m=n.intersectObjects(i,!0);if(m.length){const u=m[0].distance;return c.distanceTo(n.ray.origin)<u}return!0}function Zr(e,t){if(t instanceof He)return t.zoom;if(t instanceof We){const n=de.setFromMatrixPosition(e.matrixWorld),i=qe.setFromMatrixPosition(t.matrixWorld),c=t.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(c/2)*s)}else return 1}function Kr(e,t,n){if(t instanceof We||t instanceof He){const i=de.setFromMatrixPosition(e.matrixWorld),c=qe.setFromMatrixPosition(t.matrixWorld),s=i.distanceTo(c),m=(n[1]-n[0])/(t.far-t.near),u=n[1]-m*t.far;return Math.round(m*s+u)}}const Fe=e=>Math.abs(e)<1e-10?0:e;function St(e,t,n=""){let i="matrix3d(";for(let c=0;c!==16;c++)i+=Fe(t[c]*e.elements[c])+(c!==15?",":")");return n+i}const Jr=(e=>t=>St(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Qr=(e=>(t,n)=>St(t,e(n),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function en(e){return e&&typeof e=="object"&&"current"in e}const gn=y.forwardRef(({children:e,eps:t=.001,style:n,className:i,prepend:c,center:s,fullscreen:m,portal:u,distanceFactor:f,sprite:h=!1,transform:r=!1,occlude:o,onOcclude:l,castShadow:v,receiveShadow:g,material:b,geometry:p,zIndexRange:a=[16777271,0],calculatePosition:d=Vr,as:x="div",wrapperClass:_,pointerEvents:C="auto",...E},S)=>{const{gl:R,camera:P,scene:M,size:w,raycaster:j,events:H,viewport:K}=$(),[k]=y.useState(()=>document.createElement(x)),U=y.useRef(),z=y.useRef(null),W=y.useRef(0),B=y.useRef([0,0]),T=y.useRef(null),A=y.useRef(null),F=(u==null?void 0:u.current)||H.connected||R.domElement.parentNode,O=y.useRef(null),Y=y.useRef(!1),V=y.useMemo(()=>o&&o!=="blending"||Array.isArray(o)&&o.length&&en(o[0]),[o]);y.useLayoutEffect(()=>{const I=R.domElement;o&&o==="blending"?(I.style.zIndex=`${Math.floor(a[0]/2)}`,I.style.position="absolute",I.style.pointerEvents="none"):(I.style.zIndex=null,I.style.position=null,I.style.pointerEvents=null)},[o]),y.useLayoutEffect(()=>{if(z.current){const I=U.current=lr(k);if(M.updateMatrixWorld(),r)k.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const D=d(z.current,P,w);k.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${D[0]}px,${D[1]}px,0);transform-origin:0 0;`}return F&&(c?F.prepend(k):F.appendChild(k)),()=>{F&&F.removeChild(k),I.unmount()}}},[F,r]),y.useLayoutEffect(()=>{_&&(k.className=_)},[_]);const Ve=y.useMemo(()=>r?{position:"absolute",top:0,left:0,width:w.width,height:w.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...m&&{top:-w.height/2,left:-w.width/2,width:w.width,height:w.height},...n},[n,s,m,w,r]),Tt=y.useMemo(()=>({position:"absolute",pointerEvents:C}),[C]);y.useLayoutEffect(()=>{if(Y.current=!1,r){var I;(I=U.current)==null||I.render(y.createElement("div",{ref:T,style:Ve},y.createElement("div",{ref:A,style:Tt},y.createElement("div",{ref:S,className:i,style:n,children:e}))))}else{var D;(D=U.current)==null||D.render(y.createElement("div",{ref:S,style:Ve,className:i,children:e}))}});const te=y.useRef(!0);Ge(I=>{if(z.current){P.updateMatrixWorld(),z.current.updateWorldMatrix(!0,!1);const D=r?B.current:d(z.current,P,w);if(r||Math.abs(W.current-P.zoom)>t||Math.abs(B.current[0]-D[0])>t||Math.abs(B.current[1]-D[1])>t){const J=Xr(z.current,P);let X=!1;V&&(Array.isArray(o)?X=o.map(Q=>Q.current):o!=="blending"&&(X=[M]));const ae=te.current;if(X){const Q=Yr(z.current,P,j,X);te.current=Q&&!J}else te.current=!J;ae!==te.current&&(l?l(!te.current):k.style.display=te.current?"block":"none");const pe=Math.floor(a[0]/2),At=o?V?[a[0],pe]:[pe-1,0]:a;if(k.style.zIndex=`${Kr(z.current,P,At)}`,r){const[Q,Ye]=[w.width/2,w.height/2],be=P.projectionMatrix.elements[5]*Ye,{isOrthographicCamera:Ze,top:Lt,left:Dt,bottom:kt,right:zt}=P,Ft=Jr(P.matrixWorldInverse),Ht=Ze?`scale(${be})translate(${Fe(-(zt+Dt)/2)}px,${Fe((Lt+kt)/2)}px)`:`translateZ(${be}px)`;let ee=z.current.matrixWorld;h&&(ee=P.matrixWorldInverse.clone().transpose().copyPosition(ee).scale(z.current.scale),ee.elements[3]=ee.elements[7]=ee.elements[11]=0,ee.elements[15]=1),k.style.width=w.width+"px",k.style.height=w.height+"px",k.style.perspective=Ze?"":`${be}px`,T.current&&A.current&&(T.current.style.transform=`${Ht}${Ft}translate(${Q}px,${Ye}px)`,A.current.style.transform=Qr(ee,1/((f||10)/400)))}else{const Q=f===void 0?1:Zr(z.current,P)*f;k.style.transform=`translate3d(${D[0]}px,${D[1]}px,0) scale(${Q})`}B.current=D,W.current=P.zoom}}if(!V&&O.current&&!Y.current)if(r){if(T.current){const D=T.current.children[0];if(D!=null&&D.clientWidth&&D!=null&&D.clientHeight){const{isOrthographicCamera:J}=P;if(J||p)E.scale&&(Array.isArray(E.scale)?E.scale instanceof N?O.current.scale.copy(E.scale.clone().divideScalar(1)):O.current.scale.set(1/E.scale[0],1/E.scale[1],1/E.scale[2]):O.current.scale.setScalar(1/E.scale));else{const X=(f||10)/400,ae=D.clientWidth*X,pe=D.clientHeight*X;O.current.scale.set(ae,pe,1)}Y.current=!0}}}else{const D=k.children[0];if(D!=null&&D.clientWidth&&D!=null&&D.clientHeight){const J=1/K.factor,X=D.clientWidth*J,ae=D.clientHeight*J;O.current.scale.set(X,ae,1),Y.current=!0}O.current.lookAt(I.camera.position)}});const Xe=y.useMemo(()=>({vertexShader:r?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[r]);return y.createElement("group",Ie({},E,{ref:z}),o&&!V&&y.createElement("mesh",{castShadow:v,receiveShadow:g,ref:O},p||y.createElement("planeGeometry",null),b||y.createElement("shaderMaterial",{side:er,vertexShader:Xe.vertexShader,fragmentShader:Xe.fragmentShader})))});let ue=0;const yn=dt(e=>(me.onStart=(t,n,i)=>{e({active:!0,item:t,loaded:n,total:i,progress:(n-ue)/(i-ue)*100})},me.onLoad=()=>{e({active:!1})},me.onError=t=>e(n=>({errors:[...n.errors,t]})),me.onProgress=(t,n,i)=>{n===i&&(ue=i),e({active:!0,item:t,loaded:n,total:i,progress:(n-ue)/(i-ue)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),Ae=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function Ot(e,t){const n=$(s=>s.gl),i=Z(Be,Ae(e)?Object.values(e):e);return y.useLayoutEffect(()=>{t==null||t(i)},[t]),y.useEffect(()=>{if("initTexture"in n){let s=[];Array.isArray(i)?s=i:i instanceof De?s=[i]:Ae(i)&&(s=Object.values(i)),s.forEach(m=>{m instanceof De&&n.initTexture(m)})}},[n,i]),y.useMemo(()=>{if(Ae(e)){const s={};let m=0;for(const u in e)s[u]=i[m++];return s}else return i},[e,i])}Ot.preload=e=>Z.preload(Be,e);Ot.clear=e=>Z.clear(Be,e);function tn(e){return Array.isArray(e)}function Le(e=[0,0,0]){return tn(e)?e:e instanceof N||e instanceof ft?[e.x,e.y,e.z]:[e,e,e]}const wn=y.forwardRef(function({debug:t,depthTest:n=!1,polygonOffsetFactor:i=-10,map:c,mesh:s,children:m,position:u,rotation:f,scale:h,...r},o){const l=y.useRef(null);y.useImperativeHandle(o,()=>l.current);const v=y.useRef(null);return y.useLayoutEffect(()=>{const g=(s==null?void 0:s.current)||l.current.parent,b=l.current;if(!(g instanceof tr))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const p={position:new N,rotation:new ft,scale:new N(1,1,1)};if(g){q(p,{position:u,scale:h});const a=g.matrixWorld.clone();if(g.matrixWorld.identity(),!f||typeof f=="number"){const d=new rr;d.position.copy(p.position),d.lookAt(g.position),typeof f=="number"&&d.rotateZ(f),q(p,{rotation:d.rotation})}else q(p,{rotation:f});return b.geometry=new ur(g,p.position,p.rotation,p.scale),v.current&&(q(v.current,p),v.current.traverse(d=>d.raycast=()=>null)),g.matrixWorld=a,()=>{b.geometry.dispose()}}},[s,...Le(u),...Le(h),...Le(f)]),y.createElement("mesh",Ie({ref:l,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":i,"material-depthTest":n,"material-map":c},r),m,t&&y.createElement("mesh",{ref:v},y.createElement("boxGeometry",null),y.createElement("meshNormalMaterial",{wireframe:!0}),y.createElement("axesHelper",null)))});let ge=null,Rt="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function jt(e,t,n){return i=>{n&&n(i),e&&(ge||(ge=new fr),ge.setDecoderPath(typeof e=="string"?e:Rt),i.setDRACOLoader(ge)),t&&i.setMeshoptDecoder(typeof Ce=="function"?Ce():Ce)}}function Ue(e,t=!0,n=!0,i){return Z($e,e,jt(t,n,i))}Ue.preload=(e,t=!0,n=!0,i)=>Z.preload($e,e,jt(t,n,i));Ue.clear=e=>Z.clear($e,e);Ue.setDecoderPath=e=>{Rt=e};const bn=y.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:i,enableDamping:c=!0,keyEvents:s=!1,onChange:m,onStart:u,onEnd:f,...h},r)=>{const o=$(E=>E.invalidate),l=$(E=>E.camera),v=$(E=>E.gl),g=$(E=>E.events),b=$(E=>E.setEvents),p=$(E=>E.set),a=$(E=>E.get),d=$(E=>E.performance),x=t||l,_=i||g.connected||v.domElement,C=y.useMemo(()=>new dr(x),[x]);return Ge(()=>{C.enabled&&C.update()},-1),y.useEffect(()=>(s&&C.connect(s===!0?_:s),C.connect(_),()=>void C.dispose()),[s,_,n,C,o]),y.useEffect(()=>{const E=P=>{o(),n&&d.regress(),m&&m(P)},S=P=>{u&&u(P)},R=P=>{f&&f(P)};return C.addEventListener("change",E),C.addEventListener("start",S),C.addEventListener("end",R),()=>{C.removeEventListener("start",S),C.removeEventListener("end",R),C.removeEventListener("change",E)}},[m,u,f,C,o,b]),y.useEffect(()=>{if(e){const E=a().controls;return p({controls:C}),()=>p({controls:E})}},[e,C]),y.createElement("primitive",Ie({ref:r,object:C,enableDamping:c},h))}),En=y.forwardRef(({children:e,enabled:t=!0,speed:n=1,rotationIntensity:i=1,floatIntensity:c=1,floatingRange:s=[-.1,.1],autoInvalidate:m=!1,...u},f)=>{const h=y.useRef(null);y.useImperativeHandle(f,()=>h.current,[]);const r=y.useRef(Math.random()*1e4);return Ge(o=>{var l,v;if(!t||n===0)return;m&&o.invalidate();const g=r.current+o.clock.getElapsedTime();h.current.rotation.x=Math.cos(g/4*n)/8*i,h.current.rotation.y=Math.sin(g/4*n)/8*i,h.current.rotation.z=Math.sin(g/4*n)/20*i;let b=Math.sin(g/4*n)/10;b=nr.mapLinear(b,-.1,.1,(l=s==null?void 0:s[0])!==null&&l!==void 0?l:-.1,(v=s==null?void 0:s[1])!==null&&v!==void 0?v:.1),h.current.position.y=b*c,h.current.updateMatrix()}),y.createElement("group",u,y.createElement("group",{ref:h,matrixAutoUpdate:!1},e))});function xn({all:e,scene:t,camera:n}){const i=$(({gl:m})=>m),c=$(({camera:m})=>m),s=$(({scene:m})=>m);return y.useLayoutEffect(()=>{const m=[];e&&(t||s).traverse(h=>{h.visible===!1&&(m.push(h),h.visible=!0)}),i.compile(t||s,n||c);const u=new or(128);new ir(.01,1e5,u).update(i,t||s),u.dispose(),m.forEach(h=>h.visible=!1)},[]),null}export{hn as C,wn as D,En as F,gn as H,bn as O,xn as P,vn as _,Ot as a,yn as b,Ue as u};
